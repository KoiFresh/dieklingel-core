name: dieklingel-core
title: dieKlingel Core
contact: kai.mayer@dieklingel.com
website: https://dieklingel.de/
license: GPL-3.0
version: 0.0.2+3
summary: The core of the dieKlingel project.
description: The core project containing the most important services to run the door unit.
confinement: strict
base: core22
grade: stable

architectures:
  # - build-on: amd64
  - build-on: arm64

parts:
  scripts:
    plugin: dump
    source: .
    stage:
      - home
      - scripts

  dieklingel-core:
    plugin: flutter
    source: .
    flutter-target: lib/main.dart
    build-packages:
      - curl
      - pkg-config
      - libgstreamer1.0-dev
      - libgstreamer-plugins-base1.0-dev
    stage-packages:
      - python3

apps:
  dieklingel-core:
    command: scripts/runner
    plugs:
      - home
      - network
      - camera
      - audio-playback
      - audio-record
      - wayland
    extensions: [gnome]

  daemon:
    daemon: simple
    command: scripts/runner
    passthrough:
      daemon-scope: user
    plugs:
      - home
      - network
      - camera
      - audio-playback
      - audio-record
      - wayland
    extensions: [gnome]
